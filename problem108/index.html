<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="API documentation for the Rust `problem108` crate."><meta name="keywords" content="rust, rustlang, rust-lang, problem108"><title>problem108 - Rust</title><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../dark.css"><link rel="stylesheet" type="text/css" href="../light.css" id="themeStyle"><script src="../storage.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="shortcut icon" href="../favicon.ico"><style type="text/css">#crate-search{background-image:url("../down-arrow.svg");}</style></head><body class="rustdoc mod"><!--[if lte IE 8]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu">&#9776;</div><a href='../problem108/index.html'><div class='logo-container'><img src='../rust-logo.png' alt='logo'></div></a><p class='location'>Crate problem108</p><div class="sidebar-elems"><a id='all-types' href='all.html'><p>See all problem108's items</p></a><div class="block items"><ul><li><a href="#structs">Structs</a></li><li><a href="#functions">Functions</a></li></ul></div><p class='location'></p><script>window.sidebarCurrent = {name: 'problem108', ty: 'mod', relpath: '../'};</script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!"><img src="../brush.svg" width="18" alt="Pick another theme!"></button><div id="theme-choices"></div></div><script src="../theme.js"></script><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><a id="settings-menu" href="../settings.html"><img src="../wheel.svg" width="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class='fqn'><span class='out-of-band'><span id='render-detail'><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class='inner'>&#x2212;</span>]</a></span><a class='srclink' href='../src/problem108/problem108.rs.html#1-164' title='goto source code'>[src]</a></span><span class='in-band'>Crate <a class="mod" href=''>problem108</a></span></h1><div class='docblock'><p><a href="https://projecteuler.net/problem=108">Problem 108 (Diophantine reciprocals I)</a></p>
<h1 id="solution-detail" class="section-header"><a href="#solution-detail">Solution detail</a></h1>
<p>Firstly, some rearrangement of the equation is in order. The given equation can equivalently be
written in the form <code>(x - n)(y - n) = n²</code>.</p>
<p>Given that interchanging <code>x, y</code> does not count as a new solution, the number of solutions to
this equation, and hence to the original equation, is given by <code>(d(n²) + 1) / 2</code>, where <code>d(n²)</code>
is the number of divisors of <code>n²</code>.</p>
<p>We are therefore searching for the smallest <code>n</code> for which <code>d(n²)</code> is at least 2001 (in general,
greater than <code>2 * target</code> where <code>target</code> is the number of solutions we want to be in excess of).</p>
<p>This can be done efficiently using a depth-first search through numbers having the following
properties:</p>
<ul>
<li>
<p>They are <em>smooth</em>, in the sense that they are divisible exactly by primes 2, 3, ..., <code>p</code> for
some prime <code>p</code>.</p>
</li>
<li>
<p>They are <em>descending</em>, in the sense that the exponents of their prime factors are strictly
decreasing as the prime factor increases.</p>
</li>
</ul>
<p>Given these two properties, a number is uniquely determined by the sequence of exponents in its
prime factorisation, so we can conduct the search on those without worrying about actual primes,
and only convert to the actual solution at the end.</p>
<p>Given a sequence of exponents, the number of divisors of the square of that number is equal to
the product of <code>2e + 1</code> over all exponents <code>e</code>.</p>
<p>It is therefore easy to conduct a depth-first search over all decreasing sequences of exponents,
taking those nodes which correspond to a number whose square has enough divisors, and finding,
from those nodes, the one which corresponds to the smallest actual number.</p>
<p>To spped the search up, the smallest solution so far can be stored as auxiliary data and nodes
pruned whenever the value of the node exceeds the smallest solution found so far.</p>
</div><h2 id='structs' class='section-header'><a href="#structs">Structs</a></h2>
<table><tr class='module-item'><td><a class="struct" href="struct.SquareDivisorsTree.html" title='problem108::SquareDivisorsTree struct'>SquareDivisorsTree</a></td><td class='docblock-short'><p>The state of the search for numbers whose squares have sufficiently many divisors.</p>
</td></tr><tr class='module-item'><td><a class="struct" href="struct.SquareDivisorsTreeStep.html" title='problem108::SquareDivisorsTreeStep struct'>SquareDivisorsTreeStep</a></td><td class='docblock-short'><p>A step that can be taken in the search tree</p>
</td></tr></table><h2 id='functions' class='section-header'><a href="#functions">Functions</a></h2>
<table><tr class='module-item'><td><a class="fn" href="fn.answer.html" title='problem108::answer fn'>answer</a></td><td class='docblock-short'><p>Solve the problem, returning the answer as a <code>String</code></p>
</td></tr><tr class='module-item'><td><a class="fn" href="fn.main.html" title='problem108::main fn'>main</a></td><td class='docblock-short'></td></tr><tr class='module-item'><td><a class="fn" href="fn.solve.html" title='problem108::solve fn'>solve</a></td><td class='docblock-short'><p>Find the smallest <code>n</code> for which the equation has more than <code>target</code> solutions.</p>
</td></tr></table></section><section id="search" class="content hidden"></section><section class="footer"></section><script>window.rootPath = "../";window.currentCrate = "problem108";</script><script src="../aliases.js"></script><script src="../main.js"></script><script defer src="../search-index.js"></script></body></html>